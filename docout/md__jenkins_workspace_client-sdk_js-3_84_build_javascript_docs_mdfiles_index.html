<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Zealcomm PureRTC: Zealcomm PureRTC Client SDK for JavaScript</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="zealcomm_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Zealcomm PureRTC
   &#160;<span id="projectnumber">version&nbsp;3.4.1v</span>
   </div>
   <div id="projectbrief">Zealcomm PureRTC Client SDK for Javascript*</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__jenkins_workspace_client-sdk_js-3_84_build_javascript_docs_mdfiles_index.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Zealcomm <a class="el" href="namespace_pure_r_t_c.html" title="Namespace for client API. ">PureRTC</a> Client SDK for JavaScript </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="section1"></a>
1 Introduction</h1>
<p>The Zealcomm <a class="el" href="namespace_pure_r_t_c.html" title="Namespace for client API. ">PureRTC</a> Client SDK for JavaScript provides tools to help you develop Web applications. The SDK consists of client-side APIs, as well as sample Web applications:</p>
<ul>
<li>Client-side APIs: Manage how to act with the peer client, room, and stream.</li>
</ul>
<p>The following table lists the basic JavaScript objects provided in the JavaScript SDK:</p>
 
<table class="doxtable">
<caption><b>Table 1: Basic JavaScript objects</b> </caption>
    <tbody>
    <thead>
        <tr>
            <th><b>JavaScript object</b></th>
            <th><b>Description</b></th>
        </tr>
    </thead>
        <tr>
            <td>adapter.js</td>
            <td>An adapter to interop between different browsers.</td>
        </tr>
         <tr>
            <td>purertc.sdk.js</td>
            <td>Zealcomm PureRTC client SDK for JavaScript.</td>
        </tr>
    </tbody>
</table>
<p>Refer to the SDK release notes for the latest information on the SDK release package, including features, supported browsers, bug fixes, and known issues.</p>
<p>Please include adaper.js before purertc.sdk.js in HTML files. adapter.js is an open source project hosted on <a href="https://github.com/webrtc/adapter">Github</a>. The revision we depend on is d6e8b1a45add33f382fed872f32908ea225a1996.</p>
<p>If you want to use conference SDK, please also include socket.io.js before purertc.sdk.js.</p>
<h1><a class="anchor" id="section2"></a>
2 Browser requirement</h1>
<p>The Zealcomm <a class="el" href="namespace_pure_r_t_c.html" title="Namespace for client API. ">PureRTC</a> Client SDK for JavaScript has been tested on the following browsers and operating systems:</p>
 
<table class="doxtable">
<caption><b>Table 2: Browser requirements</b></caption>
    <tbody>
    <thead>
        <tr>
            <th><b>Browser</b></th>
            <th colspan="3"><b>OS</b></th>
        </tr>
    </thead>
        <tr>
            <td><b>Conference Mode</b></td>
            <td><b>Windows*</b></td>
            <td><b>Ubuntu*</b></td>
        </tr>
        <tr width="12pt">
            <td>Chrome* 60</td>
            <td>&radic;</td>
            <td>&radic;</td>
        </tr>
        <tr>
            <td>Firefox* 55</td>
            <td>&radic;</td>
            <td>&radic;</td>
        </tr>
        <tr>
            <td>Microsoft Edge* 40.15063.0.0</td>
            <td>&radic;</td>
            <td></td>
        </tr>
        <tr>
            <td><b>P2P Mode</b></td>
            <td><b>Windows</b></td>
            <td><b>Ubuntu</b></td>
        </tr>
        <tr>
            <td>Chrome* 60</td>
            <td>&radic;</td>
            <td>&radic;</td>
        </tr>
        <tr>
            <td>Firefox* 55</td>
            <td>&radic;</td>
            <td>&radic;</td>
        </tr>
    </tbody>
</table>
<p>Different browsers may have different supported codec list. Currently, Edge browser only supports H.264 and OPUS. At the time of this writing, H.264 support in Edge is experimental. To enable it, go to "about:flags" in Edge browser, find "Enable experimental H.264/AVC support" option under WebRTC section, and then select the checkbox. Since the current H.264 support is experimental, there is some codec capability limitation such as no FIR support in Edge.</p>
<p>In P2P mode, only one stream per direction can be published between Firefox and other clients. Also, <code>unpublish</code> is not available when one side is Firefox.</p>
<h1><a class="anchor" id="section3"></a>
3 Screen sharing</h1>
<h2>3.1 Chrome</h2>
<p>We provide source code of a Chrome screen sharing extension sample. Developers should edit manifest.json and publish it to Chrome App Store to make it work for their products. After your extension is published, you will get an extension ID. This ID will be used when creating screen sharing stream.</p>
<blockquote class="doxtable">
<p><b>Note:</b> End users need to install your extension and visit your site with https if they want to use screen sharing.</p>
<p></p>
</blockquote>
<h2>3.2 Firefox</h2>
<p>Screen sharing on Firefox requires following in <code>about:config</code>.</p>
<ul>
<li><code>media.getusermedia.screensharing.enabled</code> is <code>true</code>.</li>
<li><code>media.getusermedia.screensharing.allowed_domains</code> includes your domain name. (only needed before Firefox 52)</li>
</ul>
<p>Developers can help end users to make these changes by Firefox extension.</p>
<blockquote class="doxtable">
<p><b>note:</b> End users need to visit your site with https if they want to use screen sharing.</p>
<p></p>
</blockquote>
<h1><a class="anchor" id="section4"></a>
4 NAT and firewall traversal</h1>
<p>Zealcomm <a class="el" href="namespace_pure_r_t_c.html" title="Namespace for client API. ">PureRTC</a> Client SDK for JavaScript fully supports NAT and firewall traversal with STUN / TURN / ICE. The Coturn TURN server from <a href="https://github.com/coturn/coturn">https://github.com/coturn/coturn</a> can be one choice.</p>
<h1><a class="anchor" id="section5"></a>
5 Peer-to-peer (P2P) mode</h1>
<p>To enable P2P chat, copy and paste the following code into the head section of your HTML document: </p>
<div class="fragment"><div class="line">&lt;script type=<span class="stringliteral">&quot;text/JavaScript&quot;</span> src=<span class="stringliteral">&quot;socket.io.js&quot;</span>&gt;&lt;/script&gt;</div>
<div class="line">&lt;script type=<span class="stringliteral">&quot;text/JavaScript&quot;</span> src=<span class="stringliteral">&quot;sc.websocket.js&quot;</span>&gt;&lt;/script&gt;</div>
<div class="line">&lt;script type=<span class="stringliteral">&quot;text/JavaScript&quot;</span> src=<span class="stringliteral">&quot;adapter.js&quot;</span>&gt;&lt;/script&gt;</div>
<div class="line">&lt;script type=<span class="stringliteral">&quot;text/JavaScript&quot;</span> src=<span class="stringliteral">&quot;purertc.sdk.js&quot;</span>&gt;&lt;/script&gt;</div>
</div><!-- fragment --><p> If you're using customized signling channel, please replace <code>socket.io.js</code> and <code>sc.websocket.js</code> with your own signaling channel implementation.</p>
<h2><a class="anchor" id="section5_1"></a>
5.1 P2P direct call chat</h2>
<p>Direct call chat refers to the discovery of another client by chatting with that user's ID. This is a synchronous call and requires that the two clients be online on the signaling server. </p>
<div class="fragment"><div class="line">&lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span>&gt;</div>
<div class="line">var isVideo=1;</div>
<div class="line">var serverAddress=<span class="stringliteral">&#39;http://example.com:8095/&#39;</span>;  <span class="comment">// Please change it to signaling server&#39;s address.</span></div>
<div class="line">var p2p=<span class="keyword">new</span> PureRTC.PeerClient({</div>
<div class="line">  iceServers : [ {</div>
<div class="line">    urls : <span class="stringliteral">&quot;stun:example.com&quot;</span></div>
<div class="line">  }, {</div>
<div class="line">    urls : [<span class="stringliteral">&quot;turn:example.com:4478?transport=udp&quot;</span>,<span class="stringliteral">&quot;turn:example.com:443?transport=udp&quot;</span>,<span class="stringliteral">&quot;turn:example.com:4478?transport=tcp&quot;</span>,<span class="stringliteral">&quot;turn:example.com:443?transport=tcp&quot;</span>],</div>
<div class="line">    credential : <span class="stringliteral">&quot;password&quot;</span>,</div>
<div class="line">    username : <span class="stringliteral">&quot;username&quot;</span></div>
<div class="line">  } ]</div>
<div class="line">});  <span class="comment">// Initialize a Peer object</span></div>
<div class="line">var localStream;</div>
<div class="line">var localScreen;</div>
<div class="line"></div>
<div class="line">var getTargetId=<span class="keyword">function</span>(){</div>
<div class="line">  <span class="keywordflow">return</span> $(<span class="stringliteral">&#39;#target-uid&#39;</span>).val();</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line">$(document).ready(<span class="keyword">function</span>(){</div>
<div class="line">  $(<span class="stringliteral">&#39;#target-connect&#39;</span>).click(<span class="keyword">function</span>(){</div>
<div class="line">    p2p.invite(getTargetId(), <span class="keyword">function</span>(){</div>
<div class="line">      console.log(<span class="stringliteral">&#39;Invite success.&#39;</span>);</div>
<div class="line">    }, <span class="keyword">function</span>(err){</div>
<div class="line">      console.log(<span class="stringliteral">&#39;Invite failed with message: &#39;</span>+err.message);</div>
<div class="line">    });</div>
<div class="line">  });</div>
<div class="line"></div>
<div class="line">  $(<span class="stringliteral">&#39;#target-screen&#39;</span>).click(<span class="keyword">function</span>(){</div>
<div class="line">    PureRTC.LocalStream.create({</div>
<div class="line">      video:{</div>
<div class="line">        device:<span class="stringliteral">&quot;screen&quot;</span>,</div>
<div class="line">        resolution:<span class="stringliteral">&quot;hd1080p&quot;</span>,</div>
<div class="line">        frameRate: 10</div>
<div class="line">      }</div>
<div class="line">    }, <span class="keyword">function</span>(err, stream){</div>
<div class="line">      <span class="keywordflow">if</span> (err) {</div>
<div class="line">        <span class="keywordflow">return</span> L.Logger.error(<span class="stringliteral">&#39;create LocalStream failed:&#39;</span>, err);</div>
<div class="line">      }</div>
<div class="line">      localStream = stream;</div>
<div class="line">      p2p.publish(localStream,$(<span class="stringliteral">&#39;#target-uid&#39;</span>).val());  <span class="comment">// Publish local stream to remote client</span></div>
<div class="line">    });</div>
<div class="line">  });</div>
<div class="line"></div>
<div class="line">  $(<span class="stringliteral">&#39;#target-video-unpublish&#39;</span>).click(<span class="keyword">function</span>(){</div>
<div class="line">    $(<span class="stringliteral">&#39;#target-video-publish&#39;</span>).prop(<span class="stringliteral">&#39;disabled&#39;</span>,<span class="keyword">false</span>);</div>
<div class="line">    $(<span class="stringliteral">&#39;#target-video-unpublish&#39;</span>).prop(<span class="stringliteral">&#39;disabled&#39;</span>,<span class="keyword">true</span>);</div>
<div class="line">    p2p.unpublish(localStream,$(<span class="stringliteral">&#39;#target-uid&#39;</span>).val());</div>
<div class="line">  });</div>
<div class="line"></div>
<div class="line">  $(<span class="stringliteral">&#39;#target-video-publish&#39;</span>).click(<span class="keyword">function</span>(){</div>
<div class="line">    $(<span class="stringliteral">&#39;#target-video-unpublish&#39;</span>).prop(<span class="stringliteral">&#39;disabled&#39;</span>,<span class="keyword">false</span>);</div>
<div class="line">    $(<span class="stringliteral">&#39;#target-video-publish&#39;</span>).prop(<span class="stringliteral">&#39;disabled&#39;</span>,<span class="keyword">true</span>);</div>
<div class="line">    <span class="keywordflow">if</span>(localStream)</div>
<div class="line">      p2p.publish(localStream,$(<span class="stringliteral">&#39;#target-uid&#39;</span>).val());</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">      PureRTC.LocalStream.create({</div>
<div class="line">        video:{</div>
<div class="line">          device:<span class="stringliteral">&quot;camera&quot;</span>,</div>
<div class="line">          resolution:<span class="stringliteral">&quot;hd720p&quot;</span></div>
<div class="line">        },</div>
<div class="line">      audio: <span class="keyword">true</span></div>
<div class="line">      }, <span class="keyword">function</span>(err, stream){</div>
<div class="line">        <span class="keywordflow">if</span> (err) {</div>
<div class="line">          <span class="keywordflow">return</span> L.Logger.error(<span class="stringliteral">&#39;create LocalStream failed:&#39;</span>, err);</div>
<div class="line">        }</div>
<div class="line">        localStream = stream;</div>
<div class="line">        attachMediaStream($(<span class="stringliteral">&#39;#local video&#39;</span>).<span class="keyword">get</span>(0),localStream.mediaStream)  <span class="comment">// Show local stream</span></div>
<div class="line">        p2p.publish(localStream,$(&#39;<span class="preprocessor">#target-uid&#39;).val());  // Publish local stream to remote client</span></div>
<div class="line"><span class="preprocessor"></span>      });</div>
<div class="line">    }</div>
<div class="line">  });</div>
<div class="line"></div>
<div class="line">  $(<span class="stringliteral">&#39;#target-disconnect&#39;</span>).click(<span class="keyword">function</span>(){</div>
<div class="line">    p2p.stop($(<span class="stringliteral">&#39;#target-uid&#39;</span>).val());  <span class="comment">// Stop chat</span></div>
<div class="line">  });</div>
<div class="line"></div>
<div class="line">  $(<span class="stringliteral">&#39;#login&#39;</span>).click(<span class="keyword">function</span>(){</div>
<div class="line">    p2p.connect({host:serverAddress, token:$(<span class="stringliteral">&#39;#uid&#39;</span>).val()});  <span class="comment">// Connect to peer server</span></div>
<div class="line">    $(<span class="stringliteral">&#39;#uid&#39;</span>).prop(<span class="stringliteral">&#39;disabled&#39;</span>,<span class="keyword">true</span>);</div>
<div class="line">  });</div>
<div class="line"></div>
<div class="line">  $(<span class="stringliteral">&#39;#logoff&#39;</span>).click(<span class="keyword">function</span>(){</div>
<div class="line">    p2p.disconnect();  <span class="comment">// Disconnected from peer server.</span></div>
<div class="line">    $(<span class="stringliteral">&#39;#uid&#39;</span>).prop(<span class="stringliteral">&#39;disabled&#39;</span>,<span class="keyword">false</span>);</div>
<div class="line">  });</div>
<div class="line"></div>
<div class="line">  $(<span class="stringliteral">&#39;#data-send&#39;</span>).click(<span class="keyword">function</span>(){</div>
<div class="line">    p2p.send($(<span class="stringliteral">&#39;#dataSent&#39;</span>).val(),$(<span class="stringliteral">&#39;#target-uid&#39;</span>).val());  <span class="comment">// Send data to peer.</span></div>
<div class="line">  });</div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">p2p.on(<span class="stringliteral">&#39;chat-invited&#39;</span>,<span class="keyword">function</span>(e){  <span class="comment">// Receive invitation from remote client.</span></div>
<div class="line">  $(<span class="stringliteral">&#39;#target-uid&#39;</span>).val(e.senderId);</div>
<div class="line">  p2p.accept(getTargetId());</div>
<div class="line">  <span class="comment">//p2p.deny(e.senderId);</span></div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">p2p.on(<span class="stringliteral">&#39;chat-accepted&#39;</span>, <span class="keyword">function</span>(e){</div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">p2p.on(<span class="stringliteral">&#39;chat-denied&#39;</span>,<span class="keyword">function</span>(e){</div>
<div class="line">  console.log(<span class="stringliteral">&#39;Invitation to &#39;</span>+e.senderId+<span class="stringliteral">&#39; has been denied.&#39;</span>);</div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">p2p.on(<span class="stringliteral">&#39;chat-started&#39;</span>,<span class="keyword">function</span>(e){ <span class="comment">// Chat started</span></div>
<div class="line">  console.log(<span class="stringliteral">&#39;chat started.&#39;</span>);</div>
<div class="line">  $(<span class="stringliteral">&#39;#target-screen&#39;</span>).prop(<span class="stringliteral">&#39;disabled&#39;</span>,<span class="keyword">false</span>);</div>
<div class="line">  $(<span class="stringliteral">&#39;#data-send&#39;</span>).prop(<span class="stringliteral">&#39;disabled&#39;</span>,<span class="keyword">false</span>);</div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">p2p.on(<span class="stringliteral">&#39;stream-added&#39;</span>,<span class="keyword">function</span>(e){  <span class="comment">// A remote stream is available.</span></div>
<div class="line">  <span class="keywordflow">if</span>(e.stream.isScreen()){</div>
<div class="line">    $(<span class="stringliteral">&#39;#screen video&#39;</span>).show();</div>
<div class="line">    attachMediaStream($(<span class="stringliteral">&#39;#screen video&#39;</span>).<span class="keyword">get</span>(0),e.stream.mediaStream);  <span class="comment">// Show remote screen stream.</span></div>
<div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(e.stream.hasVideo()) {</div>
<div class="line">    $(<span class="stringliteral">&#39;#remote video&#39;</span>).show();</div>
<div class="line">    attachMediaStream($(<span class="stringliteral">&#39;#remote video&#39;</span>).<span class="keyword">get</span>(0),e.stream.mediaStream);  <span class="comment">// Show remote video stream.</span></div>
<div class="line">  }</div>
<div class="line">  isVideo++;</div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">p2p.on(<span class="stringliteral">&#39;stream-removed&#39;</span>,<span class="keyword">function</span>(e){  <span class="comment">// A remote stream is available.</span></div>
<div class="line">  console.log(<span class="stringliteral">&#39;Stream removed. Stream ID: &#39;</span>+e.stream.mediaStream.id);</div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">p2p.on(<span class="stringliteral">&#39;chat-stopped&#39;</span>,<span class="keyword">function</span>(e){  <span class="comment">// Chat stopped.</span></div>
<div class="line">  console.log(<span class="stringliteral">&#39;chat stopped.&#39;</span>);</div>
<div class="line">  $(<span class="stringliteral">&#39;#data-send&#39;</span>).prop(<span class="stringliteral">&#39;disabled&#39;</span>,<span class="keyword">true</span>);</div>
<div class="line">  $(<span class="stringliteral">&#39;#remote video&#39;</span>).hide();</div>
<div class="line">  console.log(<span class="stringliteral">&#39;Chat stopped. Sender ID: &#39;</span>+e.senderId+<span class="stringliteral">&#39;, peer ID: &#39;</span>+e.peerId);</div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">p2p.on(<span class="stringliteral">&#39;data-received&#39;</span>,<span class="keyword">function</span>(e){  <span class="comment">// Received data from datachannel.</span></div>
<div class="line">  $(<span class="stringliteral">&#39;#dataReceived&#39;</span>).val(e.senderId+<span class="stringliteral">&#39;: &#39;</span>+e.data);</div>
<div class="line">});</div>
<div class="line">&lt;/script&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="section5_2"></a>
5.2 Customize signaling channel</h2>
<p>Signaling channel is an implementation to transmit signaling data for creating a WebRTC session. Signaling channel for P2P sessions can be customized by writing your own <code>sc.*.js</code>. The default Socket.IO signaling channel has been provided in the release package with name <code>sc.websocket.js</code>.</p>
<p>In the customized signaling channel, you need to implement <code>connect</code>, <code>disconnect</code> and <code>sendMessage</code>, invoke <code>onMessage</code> when a new message arrives, and invoke <code>onServerDisconnected</code> when the connection is lost. Then include your customized <code>sc.*.js</code> into the HTML page.</p>
<h1><a class="anchor" id="section6"></a>
6 Conference mode</h1>
<p>Conference mode is designed for applications with multiple participants. The JavaScript SDK includes a demo application for this.</p>
<h2><a class="anchor" id="section6_1"></a>
6.1 Join a conference from the client side</h2>
<p>To initialize your HTML code, copy and paste the following code into the head section of your HTML document: </p>
<div class="fragment"><div class="line">&lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span> src=<span class="stringliteral">&quot;socket.io.js&quot;</span>&gt;&lt;/script&gt;</div>
<div class="line">&lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span> src=<span class="stringliteral">&quot;adapter.js&quot;</span>&gt;&lt;/script&gt;</div>
<div class="line">&lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span> src=<span class="stringliteral">&quot;purertc.sdk.js&quot;</span>&gt;&lt;/script&gt;</div>
<div class="line">&lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span> src=<span class="stringliteral">&quot;purertc.sdk.ui.js&quot;</span>&gt;&lt;/script&gt;</div>
</div><!-- fragment --><p> After a room and token are created, the token can then be sent to a client to join the conference using client-side APIs: </p>
<div class="fragment"><div class="line">&lt;script type=<span class="stringliteral">&quot;text/JavaScript&quot;</span>&gt;</div>
<div class="line">L.Logger.setLogLevel(L.Logger.INFO);</div>
<div class="line">var conference = PureRTC.ConferenceClient.create({});</div>
<div class="line">conference.on(<span class="stringliteral">&#39;stream-added&#39;</span>, <span class="keyword">function</span> (event) {</div>
<div class="line">  var stream = <span class="keyword">event</span>.stream;</div>
<div class="line">  L.Logger.info(<span class="stringliteral">&#39;stream added:&#39;</span>, stream.id());</div>
<div class="line"></div>
<div class="line">  <span class="comment">// ...</span></div>
<div class="line">  <span class="keywordflow">if</span> ((subscribeMix === <span class="stringliteral">&quot;true&quot;</span> &amp;&amp; (stream.isMixed() || stream.isScreen())) ||</div>
<div class="line">    (subscribeMix !== <span class="stringliteral">&quot;true&quot;</span> &amp;&amp; !stream.isMixed())) {</div>
<div class="line">    L.Logger.info(<span class="stringliteral">&#39;subscribing:&#39;</span>, stream.id());</div>
<div class="line">    conference.subscribe(stream, <span class="keyword">function</span> () {</div>
<div class="line">      L.Logger.info(<span class="stringliteral">&#39;subscribed:&#39;</span>, stream.id());</div>
<div class="line">      displayStream(stream);</div>
<div class="line">    }, <span class="keyword">function</span> (err) {</div>
<div class="line">      L.Logger.error(stream.id(), <span class="stringliteral">&#39;subscribe failed:&#39;</span>, err);</div>
<div class="line">    });</div>
<div class="line">  }</div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">conference.on(<span class="stringliteral">&#39;stream-removed&#39;</span>, <span class="keyword">function</span> (event) {</div>
<div class="line">  <span class="comment">// Stream removed</span></div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">conference.onMessage(<span class="keyword">function</span> (event) {</div>
<div class="line">  L.Logger.info(<span class="stringliteral">&#39;Message Received:&#39;</span>, event.msg);</div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">conference.on(<span class="stringliteral">&#39;server-disconnected&#39;</span>, <span class="keyword">function</span> () {</div>
<div class="line">  L.Logger.info(<span class="stringliteral">&#39;Server disconnected&#39;</span>);</div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">conference.on(<span class="stringliteral">&#39;user-joined&#39;</span>, <span class="keyword">function</span> (event) {</div>
<div class="line">  L.Logger.info(<span class="stringliteral">&#39;user joined:&#39;</span>, event.user);</div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">conference.on(<span class="stringliteral">&#39;user-left&#39;</span>, <span class="keyword">function</span> (event) {</div>
<div class="line">  L.Logger.info(<span class="stringliteral">&#39;user left:&#39;</span>, event.user);</div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">createToken(roomId, <span class="stringliteral">&#39;user&#39;</span>, <span class="stringliteral">&#39;presenter&#39;</span>, <span class="keyword">function</span> (response) {</div>
<div class="line">  var token = response;</div>
<div class="line">  conference.join(token, <span class="keyword">function</span> (resp) {</div>
<div class="line">    PureRTC.LocalStream.create({</div>
<div class="line">      video: {</div>
<div class="line">        device: <span class="stringliteral">&#39;camera&#39;</span>,</div>
<div class="line">        resolution: myResolution</div>
<div class="line">      },</div>
<div class="line">      audio: <span class="keyword">true</span></div>
<div class="line">      }, <span class="keyword">function</span> (err, stream) {</div>
<div class="line">        <span class="keywordflow">if</span> (err) {</div>
<div class="line">          <span class="keywordflow">return</span> L.Logger.error(<span class="stringliteral">&#39;create LocalStream failed:&#39;</span>, err);</div>
<div class="line">        }</div>
<div class="line">        localStream = stream;</div>
<div class="line">        localStream.show(<span class="stringliteral">&#39;myVideo&#39;</span>);</div>
<div class="line">        conference.publish(localStream, {maxVideoBW: 300}, <span class="keyword">function</span> (st) {</div>
<div class="line">        L.Logger.info(<span class="stringliteral">&#39;stream published:&#39;</span>, st.id());</div>
<div class="line">      }, <span class="keyword">function</span> (err) {</div>
<div class="line">        L.Logger.error(<span class="stringliteral">&#39;publish failed:&#39;</span>, err);</div>
<div class="line">      });</div>
<div class="line">    });</div>
<div class="line">    <span class="comment">//…</span></div>
<div class="line">  }, <span class="keyword">function</span> (err) {</div>
<div class="line">    L.Logger.error(<span class="stringliteral">&#39;server connection failed:&#39;</span>, err);</div>
<div class="line">  });</div>
<div class="line">});</div>
<div class="line">&lt;/script&gt;</div>
</div><!-- fragment --> <h1><a class="anchor" id="section7"></a>
7 JavaScript API quick start guide</h1>
<p>This section provides detailed examples for using the APIs provided in the SDK. Unless mentioned elsewhere, all APIs are under namespace <code><a class="el" href="namespace_pure_r_t_c.html" title="Namespace for client API. ">PureRTC</a></code>.</p>
<h2><a class="anchor" id="section7_1"></a>
7.1 Objects</h2>
<p>The following table describes the key objects provided in the JavaScript SDK.  
<table class="doxtable">
<caption><b>Table 3 : JavaScript objects </b></caption>
    <tbody>
    <thead>
        <tr>
            <th><b>JavaScript object</b></th>
            <th><b>Description</b></th>
        </tr>
    </thead>
        <tr>
            <td>PeerClient</td>
            <td>Sets up one-to-one WebRTC session for two clients. It provides methods to initialize or stop a audio/video call and P2P data transmission.</td>
        </tr>
         <tr>
            <td>ConferenceClient</td>
            <td>Provides connection, local stream publication, and remote stream subscription for a audio/video conference. The conference client is created by the server side API. The conference client is retrieved by the client API with the access token for the connection.</td>
        </tr>
         <tr>
            <td>Stream</td>
            <td>Handles the WebRTC (audio, video) stream, identifies the stream, and identifies the location where the stream should be displayed. There are two stream classes: LocalStream and RemoteStream.</td>
        </tr>
    </tbody>
</table>
 <h2><a class="anchor" id="section7_2"></a>
7.2 Example: Get PeerClient</h2>
<div class="fragment"><div class="line">&lt;script type=<span class="stringliteral">&quot;text/JavaScript&quot;</span>&gt;</div>
<div class="line">  var peer = <span class="keyword">new</span> PureRTC.PeerClient({</div>
<div class="line">    iceServers : [{</div>
<div class="line">      urls : <span class="stringliteral">&quot;stun: example.com&quot;</span></div>
<div class="line">     } , {</div>
<div class="line">      urls : [<span class="stringliteral">&quot;turn:example.com:4478?transport=udp&quot;</span>, <span class="stringliteral">&quot;turn:example.com:443?transport=tcp&quot;</span>],</div>
<div class="line">      username : <span class="stringliteral">&quot;username&quot;</span>,</div>
<div class="line">      credential : <span class="stringliteral">&quot;credential&quot;</span></div>
<div class="line">     }</div>
<div class="line">    ]</div>
<div class="line">  });</div>
<div class="line">&lt;/script&gt;</div>
</div><!-- fragment --> <h2><a class="anchor" id="section7_3"></a>
7.3 Example: Get ConferenceClient</h2>
<div class="fragment"><div class="line">&lt;script type=<span class="stringliteral">&quot;text/JavaScript&quot;</span>&gt;</div>
<div class="line"> var conference = PureRTC.ConferenceClient.create({});</div>
<div class="line">&lt;/script&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="section7_4"></a>
7.4 Example: Create LocalStream and receive RemoteStream</h2>
<div class="fragment"><div class="line">&lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span>&gt;</div>
<div class="line">    <span class="comment">// LocalStream</span></div>
<div class="line">    var localStream;</div>
<div class="line">    PureRTC.LocalStream.create({</div>
<div class="line">          video: {</div>
<div class="line">              device: <span class="stringliteral">&#39;camera&#39;</span>,</div>
<div class="line">              resolution: <span class="stringliteral">&#39;vga&#39;</span>,</div>
<div class="line">          },</div>
<div class="line">          audio: <span class="keyword">true</span></div>
<div class="line">      }, <span class="keyword">function</span> (err, stream) {</div>
<div class="line">          <span class="keywordflow">if</span> (err) {</div>
<div class="line">              <span class="keywordflow">return</span> console.log(<span class="stringliteral">&#39;create LocalStream failed:&#39;</span>, err);</div>
<div class="line">          }</div>
<div class="line">          localStream = stream;</div>
<div class="line">    });</div>
<div class="line">    <span class="comment">// RemoteStream</span></div>
<div class="line">    conference.on(<span class="stringliteral">&#39;stream-added&#39;</span>, <span class="keyword">function</span> (event) {</div>
<div class="line">          var remoteStream = <span class="keyword">event</span>.stream;</div>
<div class="line">            console.log(<span class="stringliteral">&#39;stream added:&#39;</span>, stream.id());</div>
<div class="line">    });</div>
<div class="line">&lt;/script&gt;</div>
</div><!-- fragment --><h1><a class="anchor" id="Events"></a>
8 Events</h1>
<p>The JavaScript objects (described earlier in this section) throw events using EventDispatchers, inlucluding <a class="el" href="class_pure_r_t_c_1_1_peer_client.html">PeerClient</a>, <a class="el" href="class_pure_r_t_c_1_1_conference_client.html">ConferenceClient</a>, <a class="el" href="class_pure_r_t_c_1_1_remote_stream.html">RemoteStream</a>, etc.</p>
<p>For more detailed events, please refer to the specific class description page.</p>
<h2><a class="anchor" id="section8_1"></a>
8.1 Example for conference:</h2>
<div class="fragment"><div class="line">&lt;script type=<span class="stringliteral">&quot;text/JavaScript&quot;</span>&gt;</div>
<div class="line">  var conference = PureRTC.ConferenceClient.create({});</div>
<div class="line">  conference.on(<span class="stringliteral">&#39;stream-added&#39;</span>, <span class="keyword">function</span> (event) {</div>
<div class="line">var stream = <span class="keyword">event</span>.stream;</div>
<div class="line">L.Logger.info(<span class="stringliteral">&#39;stream added:&#39;</span>, stream.id());</div>
<div class="line">var fromMe = <span class="keyword">false</span>;</div>
<div class="line"><span class="keywordflow">for</span> (var i in conference.localStreams) {</div>
<div class="line">   <span class="keywordflow">if</span> (conference.localStreams.hasOwnProperty(i)) {</div>
<div class="line">     <span class="keywordflow">if</span> (conference.localStreams[i].id() === stream.id()) {</div>
<div class="line">       fromMe = <span class="keyword">true</span>;</div>
<div class="line">       <span class="keywordflow">break</span>;</div>
<div class="line">     }</div>
<div class="line">   }</div>
<div class="line">}</div>
<div class="line">L.Logger.info(<span class="stringliteral">&#39;subscribing:&#39;</span>, stream.id());</div>
<div class="line">conference.subscribe(stream, <span class="keyword">function</span> () {</div>
<div class="line">  L.Logger.info(<span class="stringliteral">&#39;subscribed:&#39;</span>, stream.id());</div>
<div class="line">  displayStream(stream);</div>
<div class="line">}, <span class="keyword">function</span> (err) {</div>
<div class="line">  L.Logger.error(stream.id(), <span class="stringliteral">&#39;subscribe failed:&#39;</span>, err);</div>
<div class="line">});</div>
<div class="line">});</div>
<div class="line">&lt;/script&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="section8_2"></a>
8.2 Example for p2p:</h2>
<div class="fragment"><div class="line">&lt;script type=<span class="stringliteral">&quot;text/JavaScript&quot;</span>&gt;</div>
<div class="line">  var startTime;</div>
<div class="line">  var p2p = <span class="keyword">new</span> PureRTC.PeerClient();</div>
<div class="line">  p2p.addEventListener(<span class="stringliteral">&#39;chat-stopped&#39;</span>,<span class="keyword">function</span> (e) {  <span class="comment">// Chat stopped</span></div>
<div class="line">    $(<span class="stringliteral">&#39;#remote video&#39;</span>).hide();</div>
<div class="line">    console.log(<span class="stringliteral">&#39;duration: &#39;</span>+(Date.now()-startTime).seconds());</div>
<div class="line">  });</div>
<div class="line"></div>
<div class="line">  p2p.addEventListener(<span class="stringliteral">&#39;chat-started&#39;</span>,<span class="keyword">function</span> (e) {  <span class="comment">// Chat started</span></div>
<div class="line">    console.log(<span class="stringliteral">&#39;duration: &#39;</span>+(Date.now()-startTime)+<span class="stringliteral">&#39;ms&#39;</span>);  <span class="comment">// Duration of the chat.</span></div>
<div class="line">  });</div>
<div class="line">&lt;/script&gt;</div>
</div><!-- fragment --><blockquote class="doxtable">
<p><b>Note</b>: * Other names and brands may be claimed as the property of others. </p>
</blockquote>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Mar 16 2018 15:14:53 for Zealcomm PureRTC version&nbsp;3.4.1v</li>
  </ul>
</div>
</body>
</html>
